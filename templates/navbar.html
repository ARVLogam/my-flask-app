<nav class="fixed inset-x-0 top-0 z-50 bg-white/90 backdrop-blur border-b border-neutral-200">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16">
    <div class="flex h-full items-center justify-between">

      <!-- Brand / Logo -->
      <a href="{{ url_for('dashboard') }}" class="flex items-center gap-2">
        <img src="{{ url_for('static', filename='img/logo.PNG') }}" alt="Logo" class="h-8 w-auto"/>
      </a>

      <!-- Desktop menu -->
      <div class="hidden md:flex items-center gap-6">
        {% set _role = role|default('user') %}

        {% if _role == 'admin' %}
          <!-- Admin dropdown -->
          <div class="relative" id="adminDropdown">
            <button type="button"
                    class="inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-green-600 text-white hover:bg-green-700">
              <i class="fa-solid fa-gear"></i>
              <span class="font-medium">Admin</span>
              <i class="fa-solid fa-caret-down"></i>
            </button>
            <div class="absolute right-0 mt-2 w-60 rounded-xl border border-neutral-200 bg-white shadow-xl hidden">
              <a href="{{ url_for('dashboard') }}" class="flex items-center gap-3 px-4 py-3 hover:bg-neutral-50"><i class="fa-solid fa-home text-neutral-700"></i> Dashboard</a>
              <a href="{{ url_for('addBarang') }}" class="flex items-center gap-3 px-4 py-3 hover:bg-neutral-50"><i class="fa-solid fa-plus text-emerald-600"></i> Tambah Barang</a>
              <a href="{{ url_for('menuAdmin', roleMenu='kelolaUser') }}" class="flex items-center gap-3 px-4 py-3 hover:bg-neutral-50"><i class="fa-solid fa-users text-violet-600"></i> Kelola User</a>
              <a href="{{ url_for('admin_orders') }}" class="flex items-center gap-3 px-4 py-3 hover:bg-neutral-50"><i class="fa-solid fa-box text-blue-600"></i> Kelola Pesanan</a>
            </div>
          </div>
        {% else %}
          <!-- Menu user -->
          <a href="{{ url_for('dashboard') }}" class="text-sm text-neutral-700 hover:text-red-600">Dashboard</a>
          <a href="{{ url_for('cart_view') }}" class="text-sm text-neutral-700 hover:text-red-600">Keranjang{% if cart_count %} ({{ cart_count }}){% endif %}</a>
          <a href="{{ url_for('orders_me') }}" class="text-sm text-neutral-700 hover:text-red-600">Pesanan Saya</a>
        {% endif %}

        <!-- Profile dropdown -->
        <div class="relative" id="profileDropdown">
          <button type="button" class="inline-flex items-center gap-2 px-3 py-2 rounded-full border border-neutral-300 hover:bg-neutral-50">
            <i class="fa-solid fa-user text-neutral-700"></i>
            <span class="hidden lg:inline text-sm text-neutral-700">Halo, {{ nama|default('Pengguna') }}</span>
            <i class="fa-solid fa-caret-down text-neutral-500"></i>
          </button>
          <div class="absolute right-0 mt-2 w-56 rounded-xl border border-neutral-200 bg-white shadow-xl hidden">
            <a href="{{ url_for('editProfile') }}" class="flex items-center gap-3 px-4 py-3 hover:bg-neutral-50"><i class="fa-solid fa-id-card text-blue-600"></i> Profil</a>
            <a href="{{ url_for('logout') }}" class="flex items-center gap-3 px-4 py-3 hover:bg-neutral-50 text-red-600"><i class="fa-solid fa-arrow-right-from-bracket"></i> Keluar</a>
          </div>
        </div>
      </div>

      <!-- Mobile menu (kanan) -->
      <div class="md:hidden flex items-center gap-3">
        {% if role == 'admin' %}
          <!-- Admin menu mobile -->
          <div class="relative" id="adminDropdownMobile">
            <button class="p-2 rounded-lg bg-green-600 text-white hover:bg-green-700">
              <i class="fa-solid fa-gear"></i>
            </button>
            <div class="absolute right-0 mt-2 w-56 rounded-xl border border-neutral-200 bg-white shadow-xl hidden">
              <a href="{{ url_for('dashboard') }}" class="block px-4 py-2 hover:bg-neutral-50">Dashboard</a>
              <a href="{{ url_for('addBarang') }}" class="block px-4 py-2 hover:bg-neutral-50">Tambah Barang</a>
              <a href="{{ url_for('menuAdmin', roleMenu='kelolaUser') }}" class="block px-4 py-2 hover:bg-neutral-50">Kelola User</a>
              <a href="{{ url_for('admin_orders') }}" class="block px-4 py-2 hover:bg-neutral-50">Kelola Pesanan</a>
            </div>
          </div>
        {% else %}
          <!-- Hamburger untuk user -->
          <div class="relative" id="userMenuMobile">
            <button class="p-2 rounded-lg border border-neutral-300 hover:bg-neutral-100">
              <i class="fa-solid fa-bars"></i>
            </button>
            <div class="absolute right-0 mt-2 w-56 rounded-xl border border-neutral-200 bg-white shadow-xl hidden">
              <a href="{{ url_for('dashboard') }}" class="block px-4 py-2 hover:bg-neutral-50">Dashboard</a>
              <a href="{{ url_for('cart_view') }}" class="block px-4 py-2 hover:bg-neutral-50">Keranjang{% if cart_count %} ({{ cart_count }}){% endif %}</a>
              <a href="{{ url_for('orders_me') }}" class="block px-4 py-2 hover:bg-neutral-50">Pesanan Saya</a>
            </div>
          </div>
        {% endif %}

        <!-- Profile mobile -->
        <div class="relative" id="profileDropdownMobile">
          <button class="p-2 rounded-full border border-neutral-300 hover:bg-neutral-100">
            <i class="fa-solid fa-user text-neutral-700"></i>
          </button>
          <div class="absolute right-0 mt-2 w-56 rounded-xl border border-neutral-200 bg-white shadow-xl hidden">
            <a href="{{ url_for('editProfile') }}" class="block px-4 py-2 hover:bg-neutral-50">Profil</a>
            <a href="{{ url_for('logout') }}" class="block px-4 py-2 hover:bg-neutral-50 text-red-600">Keluar</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

<div class="h-16"></div>

<script>
  // dropdown helper
  function setupDropdown(rootId) {
    const root = document.getElementById(rootId);
    if (!root) return;
    const btn = root.querySelector('button');
    const panel = root.querySelector('div.absolute');
    btn.addEventListener('click', () => panel.classList.toggle('hidden'));
    document.addEventListener('click', (e) => {
      if (!root.contains(e.target)) panel.classList.add('hidden');
    });
  }
  setupDropdown('adminDropdown');
  setupDropdown('profileDropdown');
  setupDropdown('adminDropdownMobile');
  setupDropdown('userMenuMobile');
  setupDropdown('profileDropdownMobile');
</script>
